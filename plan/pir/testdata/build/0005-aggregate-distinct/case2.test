SELECT COUNT(x), SUM(y), COUNT(DISTINCT x), COUNT(DISTINCT y) FROM input
---
WITH (
	ITERATE input FIELDS [x]
	FILTER DISTINCT [x]
	AGGREGATE COUNT(x) AS "count"
) AS REPLACEMENT(0)
WITH (
	ITERATE input FIELDS [y]
	FILTER DISTINCT [y]
	AGGREGATE COUNT(y) AS "count"
) AS REPLACEMENT(1)
ITERATE input FIELDS [x, y]
AGGREGATE COUNT(x) AS $_0_0, SUM(y) AS $_0_1
PROJECT $_0_0 AS "count", $_0_1 AS "sum", SCALAR_REPLACEMENT(0) AS count_3, SCALAR_REPLACEMENT(1) AS count_4
