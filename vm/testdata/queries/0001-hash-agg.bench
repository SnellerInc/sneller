# benchmark based on expanding
# some sample rows from the nyc taxi dataset
SELECT
  SUM(total_amount), COUNT(VendorID), VendorID
FROM input
GROUP BY VendorID
ORDER BY SUM(total_amount) DESC
---
{"VendorID": "VTS", "tpep_pickup_datetime": "2009-01-04T02:52:00Z", "tpep_dropoff_datetime": "2009-01-04T03:02:00Z", "passenger_count": 1, "trip_distance": 2.6299999, "pickup_longitude": -73.99195700000001, "pickup_latitude": 40.721567, "RatecodeID": 0, "store_and_fwd_flag": "", "dropoff_longitude": -73.99380300000001, "dropoff_latitude": 40.69592200000001, "payment_type": "CASH", "fare_amount": 8.9, "surcharge": 0.5, "mta_tax": 0, "tip_amount": 0, "tolls_amount": 0, "total_amount": 9.4}
{"VendorID": "VTS", "tpep_pickup_datetime": "2009-01-04T03:31:00Z", "tpep_dropoff_datetime": "2009-01-04T03:38:00Z", "passenger_count": 3, "trip_distance": 4.5499997, "pickup_longitude": -73.982102, "pickup_latitude": 40.736290000000004, "RatecodeID": 0, "store_and_fwd_flag": "", "dropoff_longitude": -73.95585, "dropoff_latitude": 40.76803000000001, "payment_type": "Credit", "fare_amount": 12.1, "surcharge": 0.5, "mta_tax": 0, "tip_amount": 2, "tolls_amount": 0, "total_amount": 14.6}
{"VendorID": "VTS", "tpep_pickup_datetime": "2009-01-03T15:43:00Z", "tpep_dropoff_datetime": "2009-01-03T15:57:00Z", "passenger_count": 5, "trip_distance": 10.35, "pickup_longitude": -74.00258699999999, "pickup_latitude": 40.739748000000006, "RatecodeID": 0, "store_and_fwd_flag": "", "dropoff_longitude": -73.869983, "dropoff_latitude": 40.770225, "payment_type": "Credit", "fare_amount": 23.7, "surcharge": 0, "mta_tax": 0, "tip_amount": 4.74, "tolls_amount": 0, "total_amount": 28.44}
{"VendorID": "DDS", "tpep_pickup_datetime": "2009-01-01T20:52:58Z", "tpep_dropoff_datetime": "2009-01-01T21:14:00Z", "passenger_count": 1, "trip_distance": 5, "pickup_longitude": -73.97426700000001, "pickup_latitude": 40.79095500000001, "RatecodeID": 0, "store_and_fwd_flag": "", "dropoff_longitude": -73.996558, "dropoff_latitude": 40.731849000000004, "payment_type": "CREDIT", "fare_amount": 14.9, "surcharge": 0.5, "mta_tax": 0, "tip_amount": 3.05, "tolls_amount": 0, "total_amount": 18.45}
{"VendorID": "DDS", "tpep_pickup_datetime": "2009-01-24T16:18:23Z", "tpep_dropoff_datetime": "2009-01-24T16:24:56Z", "passenger_count": 1, "trip_distance": 0.4, "pickup_longitude": -74.00158, "pickup_latitude": 40.719382, "RatecodeID": 0, "store_and_fwd_flag": "", "dropoff_longitude": -74.00837799999996, "dropoff_latitude": 40.72035000000001, "payment_type": "CASH", "fare_amount": 3.7, "surcharge": 0, "mta_tax": 0, "tip_amount": 0, "tolls_amount": 0, "total_amount": 3.7}
{"VendorID": "DDS", "tpep_pickup_datetime": "2009-01-16T22:35:59Z", "tpep_dropoff_datetime": "2009-01-16T22:43:35Z", "passenger_count": 2, "trip_distance": 1.2, "pickup_longitude": -73.989806, "pickup_latitude": 40.73500600000001, "RatecodeID": 0, "store_and_fwd_flag": "", "dropoff_longitude": -73.985021, "dropoff_latitude": 40.724494, "payment_type": "CASH", "fare_amount": 6.1, "surcharge": 0.5, "mta_tax": 0, "tip_amount": 0, "tolls_amount": 0, "total_amount": 6.6}
{"VendorID": "DDS", "tpep_pickup_datetime": "2009-01-21T08:55:57Z", "tpep_dropoff_datetime": "2009-01-21T09:05:42Z", "passenger_count": 1, "trip_distance": 0.4, "pickup_longitude": -73.98405, "pickup_latitude": 40.743544, "RatecodeID": 0, "store_and_fwd_flag": "", "dropoff_longitude": -73.98026000000002, "dropoff_latitude": 40.74892600000001, "payment_type": "CREDIT", "fare_amount": 5.7, "surcharge": 0, "mta_tax": 0, "tip_amount": 1, "tolls_amount": 0, "total_amount": 6.7}
{"VendorID": "VTS", "tpep_pickup_datetime": "2009-01-04T04:31:00Z", "tpep_dropoff_datetime": "2009-01-04T04:36:00Z", "passenger_count": 1, "trip_distance": 1.72, "pickup_longitude": -73.992635, "pickup_latitude": 40.74836200000001, "RatecodeID": 0, "store_and_fwd_flag": "", "dropoff_longitude": -73.995585, "dropoff_latitude": 40.72830700000001, "payment_type": "CASH", "fare_amount": 6.1, "surcharge": 0.5, "mta_tax": 0, "tip_amount": 0, "tolls_amount": 0, "total_amount": 6.6}
{"VendorID": "CMT", "tpep_pickup_datetime": "2009-01-05T16:29:02Z", "tpep_dropoff_datetime": "2009-01-05T16:40:21Z", "passenger_count": 1, "trip_distance": 1.6, "pickup_longitude": -73.96969000000001, "pickup_latitude": 40.749244000000004, "RatecodeID": 0, "store_and_fwd_flag": "", "dropoff_longitude": -73.99041300000002, "dropoff_latitude": 40.751082, "payment_type": "Credit", "fare_amount": 8.7, "surcharge": 0, "mta_tax": 0, "tip_amount": 1.3, "tolls_amount": 0, "total_amount": 10}
{"VendorID": "CMT", "tpep_pickup_datetime": "2009-01-05T18:53:13Z", "tpep_dropoff_datetime": "2009-01-05T18:57:45Z", "passenger_count": 1, "trip_distance": 0.70000005, "pickup_longitude": -73.955173, "pickup_latitude": 40.783044000000004, "RatecodeID": 0, "store_and_fwd_flag": "", "dropoff_longitude": -73.95859799999998, "dropoff_latitude": 40.774822, "payment_type": "Cash", "fare_amount": 5.9, "surcharge": 0, "mta_tax": 0, "tip_amount": 0, "tolls_amount": 0, "total_amount": 5.9}
