SELECT
    TIME_BUCKET(t, 30*60) AS bucket
FROM
  input
---
{"t": "1970-01-01T01:00:00Z"}
{"t": "1970-01-01T01:00:01Z"}
{"t": "1970-01-01T01:29:59Z"}
{"t": "1970-01-01T01:30:00Z"}
{"t": "1970-01-01T01:30:01Z"}
{"t": "1970-01-01T01:59:59Z"}
{"t": "1970-01-01T02:00:00Z"}
{"t": "1970-01-01T02:00:01Z"}
{"t": "1970-01-01T02:29:59Z"}
{"t": "1970-01-01T02:30:30Z"}
{"t": "2020-01-01T00:00:00Z"}
{"t": "2020-01-01T00:30:00Z"}
{"t": "2020-01-01T01:00:00Z"}
---
{"bucket": 3600}
{"bucket": 3600}
{"bucket": 3600}
{"bucket": 5400}
{"bucket": 5400}
{"bucket": 5400}
{"bucket": 7200}
{"bucket": 7200}
{"bucket": 7200}
{"bucket": 9000}
{"bucket": 1577836800}
{"bucket": 1577838600}
{"bucket": 1577840400}
