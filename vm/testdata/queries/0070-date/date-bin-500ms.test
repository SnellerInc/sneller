SELECT
  ts, DATE_BIN('500 milliseconds', ts, `2000-01-01T00:00:00.123333`) AS binned
FROM
  input
---
{"ts": "1901-03-05T11:37:31.000000Z"}
{"ts": "1914-03-03T02:14:53.000000Z"}
{"ts": "1920-05-14T03:57:53.000000Z"}
{"ts": "1923-10-10T05:03:18.523379Z"}
{"ts": "1929-03-28T23:07:10.537908Z"}
{"ts": "1934-06-24T17:15:38.223989Z"}
{"ts": "1940-05-28T11:37:35.966919Z"}
{"ts": "1943-01-30T14:05:10.734005Z"}
{"ts": "1959-03-20T12:45:51.000000Z"}
{"ts": "1963-11-23T14:46:19.113283Z"}
{"ts": "1980-09-19T21:47:18.000000Z"}
{"ts": "1987-10-03T18:31:59.920077Z"}
{"ts": "1991-03-12T14:40:22.000000Z"}
{"ts": "2002-05-01T03:35:32.000000Z"}
{"ts": "2004-02-28T06:51:51.000000Z"}
{"ts": "2005-11-21T19:07:42.000000Z"}
{"ts": "2006-06-02T22:30:20.469410Z"}
{"ts": "2015-10-21T12:10:24.197117Z"}
{"ts": "2025-04-21T22:32:25.000000Z"}
{"ts": "2028-03-17T12:14:10.000000Z"}
{"ts": "2036-03-07T06:54:23.000000Z"}
{"ts": "2039-05-27T06:59:24.771120Z"}
{"ts": "2057-09-28T12:17:13.000000Z"}
{"ts": "2065-10-16T06:34:22.695071Z"}
{"ts": "2069-05-13T12:45:50.379648Z"}
{"ts": "2106-01-09T19:39:37.000000Z"}
{"ts": "2123-01-04T19:55:38.000000Z"}
{"ts": "2123-03-28T22:20:28.000000Z"}
{"ts": "2131-03-07T14:44:17.000000Z"}
{"ts": "2132-12-22T01:18:54.000000Z"}
{"ts": "2133-09-24T17:35:47.000000Z"}
{"ts": "2138-07-15T01:23:31.000000Z"}
{"ts": "2145-09-07T13:43:05.877701Z"}
{"ts": "2145-12-17T19:04:17.000000Z"}
{"ts": "2153-09-04T03:13:47.000000Z"}
{"ts": "2154-11-04T21:06:05.000000Z"}
{"ts": "2157-02-04T15:15:56.070596Z"}
{"ts": "2163-06-23T07:01:45.000000Z"}
{"ts": "2174-10-19T19:30:06.762523Z"}
{"ts": "2175-09-14T17:20:19.000000Z"}
{"ts": "2199-11-26T00:34:34.098331Z"}
{"ts": "2207-08-03T05:13:09.962018Z"}
{"ts": "2209-05-16T18:43:51.463466Z"}
{"ts": "2225-12-16T04:59:59.660465Z"}
{"ts": "2229-09-05T20:19:18.000000Z"}
{"ts": "2230-09-28T11:20:54.566033Z"}
{"ts": "2237-11-01T23:15:17.000000Z"}
{"ts": "2238-09-14T06:31:03.199208Z"}
{"ts": "2251-01-06T16:07:55.322459Z"}
{"ts": "2251-11-16T04:32:27.614000Z"}
{"ts": "2254-04-15T01:09:18.237061Z"}
{"ts": "2258-06-09T06:56:07.474851Z"}
{"ts": "2262-08-04T08:52:29.000000Z"}
{"ts": "2271-06-03T21:38:46.513571Z"}
{"ts": "2275-08-25T11:29:16.452430Z"}
{"ts": "2276-07-21T11:02:39.088241Z"}
{"ts": "2277-10-09T14:39:20.000000Z"}
{"ts": "2280-08-17T08:49:46.781722Z"}
{"ts": "2282-09-06T06:33:29.000000Z"}
{"ts": "2302-04-21T15:07:09.000000Z"}
{"ts": "2302-12-08T18:11:25.935454Z"}
{"ts": "2304-02-01T17:29:48.000000Z"}
{"ts": "2304-04-12T20:08:48.723095Z"}
{"ts": "2311-04-09T22:40:52.000000Z"}
{"ts": "2314-11-30T19:19:56.000000Z"}
{"ts": "2315-08-04T00:43:57.913215Z"}
{"ts": "2318-09-25T12:17:38.000000Z"}
{"ts": "2332-06-10T10:06:57.000000Z"}
{"ts": "2334-03-28T02:09:14.073071Z"}
{"ts": "2338-04-17T21:44:57.275769Z"}
{"ts": "2338-07-08T15:35:04.731690Z"}
{"ts": "2339-02-27T13:00:06.000000Z"}
{"ts": "2342-04-04T17:31:10.806668Z"}
{"ts": "2344-12-03T10:50:17.000000Z"}
{"ts": "2346-05-25T22:33:51.651714Z"}
{"ts": "2354-03-30T09:13:02.157599Z"}
{"ts": "2355-01-22T18:42:05.000000Z"}
{"ts": "2355-07-01T11:54:39.584597Z"}
{"ts": "2364-04-05T12:08:44.561265Z"}
{"ts": "2368-03-14T19:05:39.000000Z"}
{"ts": "2372-02-22T23:18:50.558061Z"}
{"ts": "2374-04-07T18:06:57.931189Z"}
{"ts": "2374-10-05T05:57:05.570465Z"}
{"ts": "2377-12-23T08:36:21.000000Z"}
{"ts": "2383-02-02T14:53:16.836757Z"}
{"ts": "2386-06-24T06:02:12.745813Z"}
{"ts": "2400-04-04T21:36:18.000000Z"}
---
{"ts": "1901-03-05T11:37:31.000000Z", "binned": "1901-03-05T11:37:30.623333Z"}
{"ts": "1914-03-03T02:14:53.000000Z", "binned": "1914-03-03T02:14:52.623333Z"}
{"ts": "1920-05-14T03:57:53.000000Z", "binned": "1920-05-14T03:57:52.623333Z"}
{"ts": "1923-10-10T05:03:18.523379Z", "binned": "1923-10-10T05:03:18.123333Z"}
{"ts": "1929-03-28T23:07:10.537908Z", "binned": "1929-03-28T23:07:10.123333Z"}
{"ts": "1934-06-24T17:15:38.223989Z", "binned": "1934-06-24T17:15:38.123333Z"}
{"ts": "1940-05-28T11:37:35.966919Z", "binned": "1940-05-28T11:37:35.623333Z"}
{"ts": "1943-01-30T14:05:10.734005Z", "binned": "1943-01-30T14:05:10.623333Z"}
{"ts": "1959-03-20T12:45:51.000000Z", "binned": "1959-03-20T12:45:50.623333Z"}
{"ts": "1963-11-23T14:46:19.113283Z", "binned": "1963-11-23T14:46:18.623333Z"}
{"ts": "1980-09-19T21:47:18.000000Z", "binned": "1980-09-19T21:47:17.623333Z"}
{"ts": "1987-10-03T18:31:59.920077Z", "binned": "1987-10-03T18:31:59.623333Z"}
{"ts": "1991-03-12T14:40:22.000000Z", "binned": "1991-03-12T14:40:21.623333Z"}
{"ts": "2002-05-01T03:35:32.000000Z", "binned": "2002-05-01T03:35:31.623333Z"}
{"ts": "2004-02-28T06:51:51.000000Z", "binned": "2004-02-28T06:51:50.623333Z"}
{"ts": "2005-11-21T19:07:42.000000Z", "binned": "2005-11-21T19:07:41.623333Z"}
{"ts": "2006-06-02T22:30:20.469410Z", "binned": "2006-06-02T22:30:20.123333Z"}
{"ts": "2015-10-21T12:10:24.197117Z", "binned": "2015-10-21T12:10:24.123333Z"}
{"ts": "2025-04-21T22:32:25.000000Z", "binned": "2025-04-21T22:32:24.623333Z"}
{"ts": "2028-03-17T12:14:10.000000Z", "binned": "2028-03-17T12:14:09.623333Z"}
{"ts": "2036-03-07T06:54:23.000000Z", "binned": "2036-03-07T06:54:22.623333Z"}
{"ts": "2039-05-27T06:59:24.771120Z", "binned": "2039-05-27T06:59:24.623333Z"}
{"ts": "2057-09-28T12:17:13.000000Z", "binned": "2057-09-28T12:17:12.623333Z"}
{"ts": "2065-10-16T06:34:22.695071Z", "binned": "2065-10-16T06:34:22.623333Z"}
{"ts": "2069-05-13T12:45:50.379648Z", "binned": "2069-05-13T12:45:50.123333Z"}
{"ts": "2106-01-09T19:39:37.000000Z", "binned": "2106-01-09T19:39:36.623333Z"}
{"ts": "2123-01-04T19:55:38.000000Z", "binned": "2123-01-04T19:55:37.623333Z"}
{"ts": "2123-03-28T22:20:28.000000Z", "binned": "2123-03-28T22:20:27.623333Z"}
{"ts": "2131-03-07T14:44:17.000000Z", "binned": "2131-03-07T14:44:16.623333Z"}
{"ts": "2132-12-22T01:18:54.000000Z", "binned": "2132-12-22T01:18:53.623333Z"}
{"ts": "2133-09-24T17:35:47.000000Z", "binned": "2133-09-24T17:35:46.623333Z"}
{"ts": "2138-07-15T01:23:31.000000Z", "binned": "2138-07-15T01:23:30.623333Z"}
{"ts": "2145-09-07T13:43:05.877701Z", "binned": "2145-09-07T13:43:05.623333Z"}
{"ts": "2145-12-17T19:04:17.000000Z", "binned": "2145-12-17T19:04:16.623333Z"}
{"ts": "2153-09-04T03:13:47.000000Z", "binned": "2153-09-04T03:13:46.623333Z"}
{"ts": "2154-11-04T21:06:05.000000Z", "binned": "2154-11-04T21:06:04.623333Z"}
{"ts": "2157-02-04T15:15:56.070596Z", "binned": "2157-02-04T15:15:55.623333Z"}
{"ts": "2163-06-23T07:01:45.000000Z", "binned": "2163-06-23T07:01:44.623333Z"}
{"ts": "2174-10-19T19:30:06.762523Z", "binned": "2174-10-19T19:30:06.623333Z"}
{"ts": "2175-09-14T17:20:19.000000Z", "binned": "2175-09-14T17:20:18.623333Z"}
{"ts": "2199-11-26T00:34:34.098331Z", "binned": "2199-11-26T00:34:33.623333Z"}
{"ts": "2207-08-03T05:13:09.962018Z", "binned": "2207-08-03T05:13:09.623333Z"}
{"ts": "2209-05-16T18:43:51.463466Z", "binned": "2209-05-16T18:43:51.123333Z"}
{"ts": "2225-12-16T04:59:59.660465Z", "binned": "2225-12-16T04:59:59.623333Z"}
{"ts": "2229-09-05T20:19:18.000000Z", "binned": "2229-09-05T20:19:17.623333Z"}
{"ts": "2230-09-28T11:20:54.566033Z", "binned": "2230-09-28T11:20:54.123333Z"}
{"ts": "2237-11-01T23:15:17.000000Z", "binned": "2237-11-01T23:15:16.623333Z"}
{"ts": "2238-09-14T06:31:03.199208Z", "binned": "2238-09-14T06:31:03.123333Z"}
{"ts": "2251-01-06T16:07:55.322459Z", "binned": "2251-01-06T16:07:55.123333Z"}
{"ts": "2251-11-16T04:32:27.614000Z", "binned": "2251-11-16T04:32:27.123333Z"}
{"ts": "2254-04-15T01:09:18.237061Z", "binned": "2254-04-15T01:09:18.123333Z"}
{"ts": "2258-06-09T06:56:07.474851Z", "binned": "2258-06-09T06:56:07.123333Z"}
{"ts": "2262-08-04T08:52:29.000000Z", "binned": "2262-08-04T08:52:28.623333Z"}
{"ts": "2271-06-03T21:38:46.513571Z", "binned": "2271-06-03T21:38:46.123333Z"}
{"ts": "2275-08-25T11:29:16.452430Z", "binned": "2275-08-25T11:29:16.123333Z"}
{"ts": "2276-07-21T11:02:39.088241Z", "binned": "2276-07-21T11:02:38.623333Z"}
{"ts": "2277-10-09T14:39:20.000000Z", "binned": "2277-10-09T14:39:19.623333Z"}
{"ts": "2280-08-17T08:49:46.781722Z", "binned": "2280-08-17T08:49:46.623333Z"}
{"ts": "2282-09-06T06:33:29.000000Z", "binned": "2282-09-06T06:33:28.623333Z"}
{"ts": "2302-04-21T15:07:09.000000Z", "binned": "2302-04-21T15:07:08.623333Z"}
{"ts": "2302-12-08T18:11:25.935454Z", "binned": "2302-12-08T18:11:25.623333Z"}
{"ts": "2304-02-01T17:29:48.000000Z", "binned": "2304-02-01T17:29:47.623333Z"}
{"ts": "2304-04-12T20:08:48.723095Z", "binned": "2304-04-12T20:08:48.623333Z"}
{"ts": "2311-04-09T22:40:52.000000Z", "binned": "2311-04-09T22:40:51.623333Z"}
{"ts": "2314-11-30T19:19:56.000000Z", "binned": "2314-11-30T19:19:55.623333Z"}
{"ts": "2315-08-04T00:43:57.913215Z", "binned": "2315-08-04T00:43:57.623333Z"}
{"ts": "2318-09-25T12:17:38.000000Z", "binned": "2318-09-25T12:17:37.623333Z"}
{"ts": "2332-06-10T10:06:57.000000Z", "binned": "2332-06-10T10:06:56.623333Z"}
{"ts": "2334-03-28T02:09:14.073071Z", "binned": "2334-03-28T02:09:13.623333Z"}
{"ts": "2338-04-17T21:44:57.275769Z", "binned": "2338-04-17T21:44:57.123333Z"}
{"ts": "2338-07-08T15:35:04.731690Z", "binned": "2338-07-08T15:35:04.623333Z"}
{"ts": "2339-02-27T13:00:06.000000Z", "binned": "2339-02-27T13:00:05.623333Z"}
{"ts": "2342-04-04T17:31:10.806668Z", "binned": "2342-04-04T17:31:10.623333Z"}
{"ts": "2344-12-03T10:50:17.000000Z", "binned": "2344-12-03T10:50:16.623333Z"}
{"ts": "2346-05-25T22:33:51.651714Z", "binned": "2346-05-25T22:33:51.623333Z"}
{"ts": "2354-03-30T09:13:02.157599Z", "binned": "2354-03-30T09:13:02.123333Z"}
{"ts": "2355-01-22T18:42:05.000000Z", "binned": "2355-01-22T18:42:04.623333Z"}
{"ts": "2355-07-01T11:54:39.584597Z", "binned": "2355-07-01T11:54:39.123333Z"}
{"ts": "2364-04-05T12:08:44.561265Z", "binned": "2364-04-05T12:08:44.123333Z"}
{"ts": "2368-03-14T19:05:39.000000Z", "binned": "2368-03-14T19:05:38.623333Z"}
{"ts": "2372-02-22T23:18:50.558061Z", "binned": "2372-02-22T23:18:50.123333Z"}
{"ts": "2374-04-07T18:06:57.931189Z", "binned": "2374-04-07T18:06:57.623333Z"}
{"ts": "2374-10-05T05:57:05.570465Z", "binned": "2374-10-05T05:57:05.123333Z"}
{"ts": "2377-12-23T08:36:21.000000Z", "binned": "2377-12-23T08:36:20.623333Z"}
{"ts": "2383-02-02T14:53:16.836757Z", "binned": "2383-02-02T14:53:16.623333Z"}
{"ts": "2386-06-24T06:02:12.745813Z", "binned": "2386-06-24T06:02:12.623333Z"}
{"ts": "2400-04-04T21:36:18.000000Z", "binned": "2400-04-04T21:36:17.623333Z"}
